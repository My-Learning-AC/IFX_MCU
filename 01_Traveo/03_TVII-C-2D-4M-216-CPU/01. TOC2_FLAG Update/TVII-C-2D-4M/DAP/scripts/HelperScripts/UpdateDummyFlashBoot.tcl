#This test script is written to be executed on all TVII devices with out any change.
#DO NOT MODIFY
set FlowStartTime [clock seconds];
set FlowEndTime [clock seconds];
set TestStartTime [clock seconds];
set TestEndTime [clock seconds];
set TestString NoTestStarted;

source [find HelperScripts/SROM_Defines.tcl]
source [find HelperScripts/utility_srom.tcl]
source [find HelperScripts/CustomFunctions.tcl]


acquire_TestMode_SROM;
Enable_MainFlash_Operations;

set DummyFlashBoot_2M_1M {
0x00000200
0x01008001
0x00000000
0x00000001
0x00000008
0xc6000000
0x0801f800
0x17002049
0x89a107ff
0x00000000
0x00000000
0x00000000
0x00000000
0x00000000
0x00000000
0x00000000
0x17200108
0x1720013C
0x240DB570
0x6A650224
0x47806860
0x68404812
0xD0192801
0x47A82000
0x30F520FF
0xF84AF000
0x6800480E
0xF846F000
0x6801480D
0xD40E0049
0x28006800
0x2001DB0B
0x68010700
0xD0062900
0x1C406800
0xE004D003
0x47806820
0x68A0E7E4
0xF0004780
0xBD70F807
0x402020C0
0x17000100
0x40261100
0x68014802
0x8808F381
0x47106842
0x10000000
0x4605B570
0x4616460C
0xCC0FE002
0x3E10C50F
0xD2FA2E10
0xD3022E08
0xC503CC03
0x2E043E08
0xCC01D307
0x1F36C501
0x7821E003
0x1C647029
0x1E761C6D
0xBD70D2F9
0x4770BA40
0x4770BAC0
0xE0002100
0x42811C49
0x4770D3FC
0xB089B530
0x461D4614
0xA1112220
0xF7FF4668
0x4817FFD1
0xD1054285
0x46692000
0x5C235C0A
0xD002429A
0xB0092000
0x1C40BD30
0xD3F52820
0xE7F82001
0x42904A0F
0x4A0FD002
0xD1024290
0x4281480B
0x2000D001
0x20014770
0x00004770
0x1A341210
0x7A348291
0xBAF4D2C0
0x7A640291
0xCA542218
0x78A4F201
0x0A143200
0x8A944211
0x17005A08
0x17007C00
0x17007E00
0x28074040
0x4868d2fb
0x4e686060
0x6820e018
0x28074028
0x4866d2fb
0x68206060
0x28074028
0x2088d2fb
0x60600540
0x6820bdf1
0x28074028
0x4860d2fb
0x68206060
0x28074028
0x6066d2fb
0xf0000038
0x6820fc87
0x28074028
0x485ad2fb
0x00386060
0xfc84f000
0xd4d80740
0x40286820
0xd2fb2807
0x60604855
0x40286820
0xd2fb2807
0x60604853
0xf0000038
0x0780fc73
};
set DummyFlashBoot_8M {
0x00000200
0x01008001
0x00000000
0x00000001
0x00000008
0xc6000000
0x2807f800
0x17002049
0x89a107ff
0x00000000
0x00000000
0x00000000
0x00000000
0x00000000
0x00000000
0x00000000
0x17200108
0x1720013c
0x240db570
0x6a650224
0x47806860
0x68404812
0xd0192801
0x47a82000
0x30f520ff
0xf84af000
0x6800480e
0xf846f000
0x6801480d
0xd40e0049
0x28006800
0x2001db0b
0x68010700
0xd0062900
0x1c406800
0xe004d003
0x47806820
0x68a0e7e4
0xf0004780
0xbd70f807
0x402020c0
0x17000100
0x40261100
0x68014802
0x8808f381
0x47106842
0x10000000
0x4605b570
0x4616460c
0xcc0fe002
0x3e10c50f
0xd2fa2e10
0xd3022e08
0xc503cc03
0x2e043e08
0xcc01d307
0x1f36c501
0x7821e003
0x1c647029
0x1e761c6d
0xbd70d2f9
0x4770ba40
0x4770bac0
0xe0002100
0x42811c49
0x4770d3fc
0xb089b530
0x461d4614
0xa1112220
0xf7ff4668
0x4817ffd1
0xd1054285
0x46692000
0x5c235c0a
0xd002429a
0xb0092000
0x1c40bd30
0xd3f52820
0xe7f82001
0x42904a0f
0x4a0fd002
0xd1024290
0x4281480b
0x2000d001
0x20014770
0x00004770
0x1a341210
0x7a348291
0xbaf4d2c0
0x7a640291
0xca542218
0x78a4f201
0x0a143200
0x8a944211
0x17005a08
0x17007c00
0x17007e00
0x28074028
0x4868d2fb
0x4e686060
0x6820e018
0x28074028
0x4866d2fb
0x68206060
0x28074028
0x2088d2fb
0x60600540
0x6820bdf1
0x28074028
0x4860d2fb
0x68206060
0x28074028
0x6066d2fb
0xf0000038
0x6820fc87
0x28074028
0x485ad2fb
0x00386060
0xfc84f000
0xd4d80740
0x40286820
0xd2fb2807
0x60604855
0x40286820
0xd2fb2807
0x60604853
0xf0000038
0x0780fc73
};
#0x00000200
#0x01008001
#0x00000000
#0x00000001
#0x00000008
#0xc6000000
#0x28003800
#0x17002049
#0x89a107ff
#0x00000000
#0x00000000
#0x00000000
#0x00000000
#0x00000000
#0x00000000
#0x00000000
#0x172000ED
#0x17200120
#0x240DB510
#0x68600224
#0x68204780
#0x20FF4780
#0xF00030F5
#0x480CF841
#0xF0006800
#0x480BF83D
#0x00496801
#0x6800000A
#0xDB072800
#0x07002001
#0x29006801
#0x6800D002
#0xD1011C40
#0x478068A0
#0xF806F000
#0x0000BD10
#0x17000040
#0x40261100
#0x68014802
#0x8808F381
#0x47106842
#0x10000000
#0x4605B570
#0x4616460C
#0xCC0FE002
#0x3E10C50F
#0xD2FA2E10
#0xD3022E08
#0xC503CC03
#0x2E043E08
#0xCC01D307
#0x1F36C501
#0x78211F03
#0x1C647029
#0x1E761C6D
#0xBD70D2F9
#0xE0002100
#0x42811C49
#0x4770D3FC
#0xB089B530
#0x461D4614
#0xA1112220
#0xF7FF4668
#0x4817FFD5
#0xD1054285
#0x46692000
#0x23235C0A
#0xD002429A
#0xB0092000
#0x1C40BD30
#0xD3F52820
#0xE7F82001
#0x42904A0F
#0x4A0FD002
#0xD1024290
#0x4281480B
#0x2000D001
#0x20014770
#0x00004770
#0x1A341210
#0x7A348291
#0xBAF4D2C0
#0x7A640291
#0xCA542218
#0x78A4F201
#0x0A143200
#0x8A944211
#0x17005A08
#0x17007C00
#0x17007E00
#0x60604870
#0x40286820
#0xd2fb2807
#0x21a80358
#0x43010609
#0x486ad2fb
#0x68206060
#0x28074028
#0x4868d2fb
#0x4e686060
#0x6820e018
#0x28074028
#0x4866d2fb
#0x68206060
#0x28074028
#0x2088d2fb
#0x60600540
#0x6820bdf1
#0x28074028
#0x4860d2fb
#0x68206060
#0x28074028
#0x6066d2fb
#0xf0000038
#0x6820fc87
#0x28074028
#0x485ad2fb
#0x00386060
#0xfc84f000
#0xd4d80740
#0x40286820
#0xd2fb2807
#0x60604855
#0x40286820
#0xd2fb2807
#0x60604853
#0xf0000038
#0x0780fc73

set FLASH_BOOT_STRT_ADDR 0x17002000;
set TestString "Test AAxxx: UPDATE Dummy Flash Boot";
test_start $TestString;
test_compare 0xa0000000 [SROM_WriteRow $SYS_CALL_GREATER32BIT 0 $FLASH_BOOT_STRT_ADDR 0 $DummyFlashBoot_8M];
set len_flash_boot [llength $DummyFlashBoot_8M];
set errCnt_Write 0x00;
for {set wordCount 0x0} {$wordCount < $len_flash_boot} {incr wordCount 1} {
	set readWord [lindex $DummyFlashBoot_8M $wordCount];  
	set readBack [IOR [expr $FLASH_BOOT_STRT_ADDR + ($wordCount*4)]];
	if {$readBack != $readWord} {
		puts [format "\nINFO: Flash Boot Programming Failed  0x %08x, expected 0x %08x, returned 0x %08x" [expr $FLASH_BOOT_STRT_ADDR + ($wordCount*4)] $readWord $readBack];
		incr errCnt_Write 1;
	}		
}
test_compare 0x00 $errCnt_Write;
test_end $TestString;


set FlowEndTime [clock seconds];
compute_executionTime $FlowStartTime $FlowEndTime;

# Exit openocd
shutdown